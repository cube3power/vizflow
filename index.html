<!doctype html5>
<html>
  <head>
    <style>

      body { 

        margin: 0;
        font: 13pt courier;
        font-weight: bold;
        background-color: #FFF;
        overflow-y:hidden;
        color: #ccc;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;        

       }

    </style>
  </head>
  <body>
    <!-- <script type="text/javascript" src="jspm_packages/system.js"></script> -->
    <!-- <script type="text/javascript" src="config.js"></script> -->

    <script type="text/javascript" src="vizflow.js"></script>
    <script type="text/javascript" src="vizflow-helper.js"></script>

    <!-- <script type="text/javascript" src="examples/three_circles_svg/three_circles_svg.js"></script>-->
    
    <script>

      var imageList = ['./image/vizflow_text.png'] ;
      var audioList = [] ;

      $Z.helper.loader.all(imageList, audioList, show_logo) ;

      function show_logo() {

        // console.log('show logo start') ;

        document.ratio = 1 ;

        var viz = $Z.helper.viz.setup({
          width:  1600,
          height: 1600,
        }) ;

        document.viz = viz ;

        viz.run() ;

        var vtxt = ['v', 'i', 'z', 'f', 'l', 'o', 'w'] ;
        var size = 197 ;
        var spriteImage = $Z.helper.image.to_canvas( imageList[0] ) ;
        spriteImage.clear_color([255, 255, 255]) ;

        viz.logo = {

          text: vtxt,
          sprite: $Z.helper.sprite.get( spriteImage, vtxt, size, size ),
          item: new Array( vtxt.length ),

        } ;

        var xOrigin = 0.5 * size ;
        var yOrigin = 0.5 * size ;

        var xmid = viz.width  * 0.5 ;
        var ymid = viz.height * 0.5 ; 

        var x0 = ( viz.width - spriteImage.height ) * 0.5 + xOrigin ;
        var y0 = ymid + yOrigin ;

        var delay = 200 ;

        var xpad  =  10 ;
        var xoff1 = -xpad * 2 ;       // shift the "i" relative to "v" 
        var xoff2 = -2.5 * xpad ; // shift more letters
        var xoff3 =  2.5 * xpad ; // shift the letters some more 

        for ( ktxt = vtxt.length - 1 ; ktxt >= 0 ; ktxt-- ) {

          var x = x0 + ktxt * (size + xpad) ;

          if ( ktxt > 0 ) {
            x += xoff1 ;
          }

          if ( ktxt > 1 ) {
            x += xoff2 ;
          }

          if ( ktxt > 2 ) {
            x += xoff3 ;
          }

          viz.logo[ktxt] = viz.setup_item({

            image: viz.logo.sprite[viz.logo.text[ktxt]][0],
            x: x,
            y: y0,
            xOrigin: xOrigin,
            yOrigin: yOrigin,
            addSwitch: true,
            opacity: 0,

          }) ;

          viz.logo[ktxt].call('fade', ktxt * delay) ;

        }

        var Nspin       = 5 ;
        var tSpin       = 250 ;
        var duration    = Nspin * tSpin ;
        var endAngle    = Math.PI * 2 * Nspin ;
        var angle_func  = $Z.helper.transition.fixed_duration('angle', duration) ;
        var spinTrans   = angle_func(endAngle) ;

        spinTrans.power = 0.15 ; 

        // spinTrans.end = function() {
        //   viz.shake() ;
        // }

        function add_spin() { this.add_transition(spinTrans) ; }

        viz.logo[2].call( add_spin, delay * vtxt.length * 2 ) ;

      }

    </script>

  </body>
</html>
