<!doctype html5>
<html>
  <head>
    <style>

      body { 

        margin: 0;
        font: 13pt courier;
        font-weight: bold;
        background-color: #FFF;
        overflow-y:hidden;
        color: #ccc;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;        

       }

    </style>

      <link rel="icon" href="./favicon.ico?v=1" />

      <meta charset="UTF-8">
      <meta name="viewport" content="initial-scale=1.0,width=device-width,maximum-scale=1,user-scalable=no,minimal-ui">
      <meta name="Election Fighter" content="Vizflow is an ES6 render-loop library">

      <title>Vizflow</title>

      <meta name="vizflow" content="ES6 render-loop library" />

      <!-- Twitter Card data -->
      <meta name="twitter:card" value="Vizflow: ES6 render-loop library">

      <!-- Open Graph data -->
      <meta property="og:title" content="Vizflow is a general purpose ES6 render loop library" />
      <meta property="og:type" content="software" />
      <meta property="og:url" content="http://www.vizflow.org/" />
      <meta property="og:image" content="http://www.vizflow.org/thumbnail.png" />
      <meta property="og:description" content="Vizflow is an ES6 render-loop library for adding interactive visualizations to HTML5 apps" />

    </head>
  <body>
    <!-- <script type="text/javascript" src="jspm_packages/system.js"></script> -->
    <!-- <script type="text/javascript" src="config.js"></script> -->

    <script type="text/javascript" src="vizflow.js"></script>
    <script type="text/javascript" src="vizflow-helper.js"></script>

    <!-- <script type="text/javascript" src="examples/three_circles_svg/three_circles_svg.js"></script>-->
    
    <script>

      var imageList = ['./image/vizflow_text.png'] ;
      var audioList = [] ;

      $Z.helper.loader.all(imageList, audioList, show_logo) ;

      function show_logo() {

        // console.log('show logo start') ;

        document.ratio = 1 ;

        var viz = $Z.helper.viz.setup({
          width:  800,
          height: 800,
        }) ;

        document.viz = viz ;

        viz.run() ;

        var vtxt = ['v', 'i', 'z', 'f', 'l', 'o', 'w'] ;
        var size = 95 ;
        var spriteImage = $Z.helper.image.to_canvas( imageList[0] ) ;
        spriteImage.clear_color([255, 255, 255]) ;

        viz.logo = {

          text: vtxt,
          sprite: $Z.helper.sprite.get( spriteImage, vtxt, size, size ),
          item: new Array( vtxt.length ),

        } ;

        var xOrigin = 0.5 * size ;
        var yOrigin = 0.5 * size ;

        var xmid = viz.width  * 0.5 ;
        var ymid = viz.height * 0.5 ; 

        var x0 = ( viz.width - spriteImage.height ) * 0.5 + xOrigin ;
        var y0 = ymid ;

        var delay = 200 ;

        var xpad  =  10 ;
        var xoff1 = -xpad * 2 ;   // shift the "i" relative to "v" 
        var xoff2 = -2.5 * xpad ; // shift more letters
        var xoff3 =  .5 * xpad ; // shift the letters some more 

        for ( ktxt = vtxt.length - 1 ; ktxt >= 0 ; ktxt-- ) {

          var x = x0 + ktxt * (size + xpad) ;

          if ( ktxt > 0 ) {
            x += xoff1 ;
          }

          if ( ktxt > 1 ) {
            x += xoff2 ;
          }

          if ( ktxt > 2 ) {
            x += xoff3 ;
          }

          viz.logo.item[ktxt] = viz.setup_item({

            image: viz.logo.sprite[viz.logo.text[ktxt]][0],
            x: x,
            y: y0,
            xOrigin: xOrigin,
            yOrigin: yOrigin,
            addSwitch: true,
            opacity: 0,

          }) ;

          viz.logo.item[ktxt].call('fade', ktxt * delay) ;

        }

        var Nspin      = 5 ;
        var tSpin      = 250 ;
        var duration   = Nspin * tSpin ;
        var endAngle   = Math.PI * 2 * Nspin ;
        var angle_func = $Z.helper.transition.fixed_duration('angle', duration) ;
        var spinTrans  = angle_func(endAngle) ;

        spinTrans.power = 0.15 ; 

        spinTrans.end = function () {
          var ytrans = $Z.helper.transition.new_linear('y', size * 0.5 + 100, 1000) ;
          viz.logo.item.forEach(function(d, i) {
            d.call('fade', i * delay) ;
          }) ;
        }

        viz.call(function(){
          window.location.reload() ;
        }, delay * 40) ;

        // spinTrans.end = function() {
        //   viz.shake() ;
        // }

        function add_spin() { 
          this.add_transition(spinTrans) ; 
        }

        viz.logo.item[2].call( add_spin, delay * vtxt.length * 2 ) ;

      }

    </script>

    <script type="text/javascript" src="analytics.js"></script>    

  </body>
</html>
